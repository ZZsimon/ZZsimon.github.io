(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"134":function(e,t,a){e.exports={"container":"index-module__container___1lg46","header":"index-module__header___3sWDr","logoArea":"index-module__logoArea___2eq9O","name":"index-module__name___3teIS","status":"index-module__status___2-MnD","controlArea":"index-module__controlArea___3Hnw2","inline":"index-module__inline___2iSVD","inlineButton":"index-module__inlineButton___1hKxk","button":"index-module__button___3KEd8","buttonDisabled":"index-module__buttonDisabled___3FMEM","qrcode":"index-module__qrcode___yjwv-","btnArea":"index-module__btnArea___28wKu","content":"index-module__content___33V5j","left":"index-module__left___1opqT","listWrap":"index-module__listWrap___1Zty-","listItem":"index-module__listItem___3phvP","middle":"index-module__middle___3vTic","pageList":"index-module__pageList___3AaoX","pageListItem":"index-module__pageListItem___3e3Uw","title":"index-module__title___1vGCQ","active":"index-module__active___20l00","canvasWrapper":"index-module__canvasWrapper___35OKl","grid":"index-module__grid___18Ify","canvasBox":"index-module__canvasBox___3eYtQ","canvas":"index-module__canvas___3nZV3","right":"index-module__right___-nzH2","rightTitle":"index-module__rightTitle___3sRwS","rightContent":"index-module__rightContent___1S-Hb","formItem":"index-module__formItem___2jV42","label":"index-module__label___12HQn","emptyEditData":"index-module__emptyEditData___nLQUC","modalWrap":"index-module__modalWrap___2dQIP","modalFormItem":"index-module__modalFormItem___3v0AP","radioWrapper":"index-module__radioWrapper___fzp_-","radio":"index-module__radio___emxM5","footer":"index-module__footer___3JT4K","inline2":"index-module__inline2___3PrbZ","mask":"index-module__mask___1gbEa","menuList":"index-module__menuList___2af3C","menuItem":"index-module__menuItem___173KQ"}},"256":function(e,t,a){e.exports={"eventsNone":"index-module__eventsNone___yHTMY","imageWrapper":"index-module__imageWrapper___24EHE","inputContentWrapper":"index-module__inputContentWrapper___vn1YM","submit":"index-module__submit___qfsBT","initNumber":"index-module__initNumber___2TlBK","floatClick":"index-module__floatClick___19Ef4","imgTpl":"index-module__imgTpl___2yd4-","image":"index-module__image___1H5Bb","title":"index-module__title___22gf1"}},"795":function(e,t,a){e.exports={"eventsNone":"index-module__eventsNone___EY9iy","imageWrapper":"index-module__imageWrapper___o9y4-","image":"index-module__image___22VNZ","wxImgButton":"index-module__wxImgButton___AMBOO","wxImg":"index-module__wxImg___2qnt1","imgTpl":"index-module__imgTpl___2Q6uL","title":"index-module__title___3isY0"}},"796":function(e,t,a){e.exports={"imgTpl":"tpl-module__imgTpl___3Al_q","image":"tpl-module__image___1wzgC","title":"tpl-module__title___1k93j"}},"797":function(e,t,a){e.exports={"eventsNone":"index-module__eventsNone___3d-0-","bgUrl":"index-module__bgUrl___2xNMk","contentBg":"index-module__contentBg___1ftQV","code":"index-module__code___F3tGH","text":"index-module__text___1z8dL","preview":"index-module__preview___7saH7","wxWrapper":"index-module__wxWrapper___NqhmH","wx":"index-module__wx___3rVHr","copy":"index-module__copy___2jzwb","imgTpl":"index-module__imgTpl___2MWtV","image":"index-module__image___3Sa05","title":"index-module__title___3liUE"}},"798":function(e,t,a){e.exports={"imageWrapper":"index-module__imageWrapper___KPr-b","eventsNone":"index-module__eventsNone___247RA","removeBgColor":"index-module__removeBgColor___nyyIa","wxImgButton":"index-module__wxImgButton___2vwRS","wxImg":"index-module__wxImg___13E9N","imgTpl":"index-module__imgTpl___3LMxj","image":"index-module__image___3Piet","title":"index-module__title___1OG-z"}},"799":function(e,t,a){e.exports={"eventsNone":"index-module__eventsNone___3ArRL","imageWrapper":"index-module__imageWrapper___2StxZ","textBox":"index-module__textBox___11Q3z","text":"index-module__text___baRAF","imgTpl":"index-module__imgTpl___ZwbIa","image":"index-module__image___H22ao","title":"index-module__title___2bjcf"}},"800":function(e,t,a){e.exports={"imgTpl":"tpl-module__imgTpl___1maYd","image":"tpl-module__image___1hACh","title":"tpl-module__title___2k9e1"}},"813":function(e,t,a){e.exports={"basePointDataWrapper":"viewRender-module__basePointDataWrapper___3iEpd","floatPointDataWrapper":"viewRender-module__floatPointDataWrapper___fJ5vj","dragItem":"viewRender-module__dragItem___25pwa","dragItemHotZone":"viewRender-module__dragItemHotZone___3nVT3","dragItemChild":"viewRender-module__dragItemChild___1msbV","dragItemHotZoneChild":"viewRender-module__dragItemHotZoneChild___WTUL2"}},"814":function(e,t,a){e.exports={"inputWrapper":"index-module__inputWrapper___2_wNL"}},"815":function(e,t,a){e.exports={"selectWrapper":"index-module__selectWrapper___3qMkS","selectInput":"index-module__selectInput___2iczP","selectInputActive":"index-module__selectInputActive___mm1tA","optionList":"index-module__optionList___1lezm","optionItem":"index-module__optionItem___2TyXl","optionItemAcitve":"index-module__optionItemAcitve___1k_63","active":"index-module__active___3uuWS"}},"816":function(e,t,a){e.exports={"upload":"index-module__upload___328iJ","imgUrl":"index-module__imgUrl___kCbYQ"}},"817":function(e,t,a){e.exports={"inputWrapper":"index-module__inputWrapper___roctk","dbInput":"index-module__dbInput___2HcTD"}},"930":function(e,t,a){e.exports={"inputWrapper":"index-module__inputWrapper___2Y81c","target":"index-module__target___1AYz3","targetInput":"index-module__targetInput___31agT","popover":"index-module__popover___1Slh7","cover":"index-module__cover___20PO9"}},"946":function(e,t,a){"use strict";a.r(t);a(384),a(38);var n=a(938),o=a(943),l=a(15),i=a.n(l),c=a(2),r=a(10),u=a(6),s=a(16),m=a.n(s),p=a(19),d=a(30),g=a(255),f=a.n(g),_=a(109),b=i.a.createContext(""),v=a(751),y=a.n(v);function request(e,t){return _request.apply(this,arguments)}function _request(){return(_request=Object(p.a)(m.a.mark((function _callee(e,t){var a,n,o,l=arguments;return m.a.wrap((function _callee$(i){for(;;)switch(i.prev=i.next){case 0:return a=l.length>2&&void 0!==l[2]?l[2]:{},i.prev=1,i.next=4,y()(Object(c.a)({"method":"post","url":e,"data":t},a));case 4:return n=i.sent,o=n.data,i.abrupt("return",o);case 9:i.prev=9,i.t0=i.catch(1),console.log(i.t0,"error"),Object(d.showToast)({"title":"网络不佳 请稍后再试","icon":"none","duration":1e3});case 13:case"end":return i.stop()}}),_callee,null,[[1,9]])})))).apply(this,arguments)}var h=window.location.href.indexOf("home")>-1,E={"1":[{"pageId":1,"pointData":[],"title":""},{"pageId":2,"pointData":[],"title":"最后一页\b"}],"2":[{"pageId":1,"pointData":[],"title":""},{"pageId":2,"pointData":[],"title":"中间的页面"},{"pageId":3,"pointData":[],"title":"最后一页"}],"3":[{"pageId":1,"pointData":[],"title":""}],"4":[{"pageId":1,"pointData":[],"title":""},{"pageId":4,"pointData":[],"title":"中间的页面1"},{"pageId":2,"pointData":[],"title":"中间的页面2"},{"pageId":3,"pointData":[],"title":"最后一页"}]},x=a(769),O=a(134),j=a.n(O),k=[{"value":1,"text":"H5"}],D=[{"value":1,"text":"场景1"},{"value":2,"text":"场景2"},{"value":4,"text":"场景3"},{"value":3,"text":"场景4"}],C=function PageModal(e){var t=e.pageInfo,a=e.setvisible,n=(d.default.useRouter().params.topicId,t||{}),o=n.pageTitle,c=n.pageSubTitle,r=n.pageType,s=n.pageScenes,g=Object(l.useState)(o),f=Object(u.a)(g,2),b=f[0],v=f[1],y=Object(l.useState)(c),h=Object(u.a)(y,2),E=h[0],O=h[1],C=Object(l.useState)(r||1),N=Object(u.a)(C,2),I=N[0],S=N[1],w=Object(l.useState)(s),P=Object(u.a)(w,2),T=P[0],z=P[1],W=function(){var e=Object(p.a)(m.a.mark((function _callee(){var e;return m.a.wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:e={"data":{"pageTitle":b,"topicName":E,"topicType":I,"applicationScenarios":T,"elements":[],"isPublish":0,"topicId":Object(x.v4)().replace(/-/g,"")}},localStorage.removeItem("topicDetailData"),localStorage.setItem("topicDetailData",JSON.stringify(e)),d.default.redirectTo({"url":"/home?topicId=".concat(e.data.topicId)});case 4:case"end":return t.stop()}}),_callee)})));return function setTopicPage(){return e.apply(this,arguments)}}();return i.a.createElement(_.e,null,i.a.createElement(_.e,{"className":j.a.modalWrap},i.a.createElement(_.e,{"className":j.a.content},i.a.createElement(_.e,{"className":j.a.title},"页面设置"),i.a.createElement(_.e,{"className":j.a.modalFormItem},i.a.createElement(_.d,{"className":j.a.label},"页面标题"),i.a.createElement(_.c,{"maxlength":20,"placeholder":"页面打开时的顶部标题","value":b,"onInput":function changePageTitle(e){var t=e.target.value;v(t)},"type":"text"})),i.a.createElement(_.e,{"className":j.a.modalFormItem},i.a.createElement(_.d,{"className":j.a.label},"样式标题"),i.a.createElement(_.c,{"maxlength":57,"placeholder":"用于区分页面用途","value":E,"onInput":function changePageSubTitle(e){var t=e.target.value;O(t)},"type":"text"})),i.a.createElement(_.e,{"className":j.a.modalFormItem},i.a.createElement(_.d,{"className":j.a.label},"应用平台"),i.a.createElement(_.e,{"className":j.a.radioWrapper},k.map((function(e){return i.a.createElement(_.e,{"className":j.a.radio,"style":{"backgroundColor":e.value===I?"#00a9ff":"","color":e.value===I?"#fff":"","pointerEvents":o||2===e.value?"none":"auto","opacity":o||2===e.value?"0.5":"1"},"onClick":function onClick(){e.value!==I&&S(e.value)},"key":e.value,"value":e.value},e.text)})))),i.a.createElement(_.e,{"className":j.a.modalFormItem},i.a.createElement(_.d,{"className":j.a.label},"应用场景"),i.a.createElement(_.e,{"className":j.a.radioWrapper},D.map((function(e){return i.a.createElement(_.e,{"className":j.a.radio,"style":{"backgroundColor":T===e.value?"#00a9ff":"","color":T===e.value?"#fff":"","pointerEvents":o?"none":"auto","opacity":o?"0.5":"1"},"onClick":function onClick(){e.value!==T&&z(e.value)},"key":e.value,"value":e.value},e.text)})))),i.a.createElement(_.e,{"className":j.a.footer},o?i.a.createElement(_.a,{"onClick":function onClick(){return a(!1)},"className":j.a.inline},"取消"):null,i.a.createElement(_.a,{"onClick":W,"type":"primary","className":"".concat(j.a.inline," ").concat(j.a.inline2)},"确定")))),i.a.createElement(_.e,{"className":j.a.mask}))},N=(a(786),a(787)),I=a.n(N),S={"1":"H5","2":"小程序"},w=Object(l.memo)((function(){var e=d.default.useRouter(),t=(e.params.topicId,Object(l.useContext)(b)),a=t.submit,n=t.publish,o=t.setvisible,c=t.pageInfo,r=c||{},s=r.pageTitle,g=r.pageType,f=r.isPublish,v=Object(l.useState)(!1),y=Object(u.a)(v,2),h=y[0],E=y[1],x=Object(l.useState)(""),O=Object(u.a)(x,2),k=O[0],D=O[1],C=function _setshowQrcode(){E(!1)};Object(l.useEffect)((function(){return document.addEventListener("click",C),function(){document.removeEventListener("click",C)}}),[]);var N=function(){var e=Object(p.a)(m.a.mark((function _callee(){return m.a.wrap((function _callee$(e){for(;;)switch(e.prev=e.next){case 0:D(""),E(!0);case 2:case"end":return e.stop()}}),_callee)})));return function getQrCode(){return e.apply(this,arguments)}}();return i.a.createElement(_.e,{"className":j.a.header},s&&i.a.createElement(_.e,{"className":j.a.logoArea},i.a.createElement(_.e,{"className":j.a.name},S[g]," ","-"," ",s),i.a.createElement(_.e,{"className":j.a.status,"style":{"backgroundColor":f?"rgb(135, 208, 104)":"#ff4d4f"}},f?"已发布":"未发布")),i.a.createElement(_.e,{"className":j.a.controlArea},i.a.createElement(_.a,{"className":j.a.inline,"type":"primary","onClick":function onClick(){localStorage.clear(),window.location.reload()}},"清空数据"),i.a.createElement(_.a,{"className":j.a.inline,"type":"primary","onClick":function setPage(){o(!0)}},"页面设置"),i.a.createElement(_.e,{"className":j.a.inlineButton},i.a.createElement(_.a,{"disabled":!0,"className":j.a.buttonDisabled,"type":"primary","onClick":function onClick(e){return function toQrcode(e){e.stopPropagation(),a(N)}(e)}},"预览"),h?i.a.createElement(_.e,{"className":j.a.qrcode},i.a.createElement(I.a,{"value":k})):null),i.a.createElement(_.a,{"className":j.a.inline,"type":"primary","onClick":function save(){a((function(){return Object(d.showToast)({"title":"保存成功","icon":"none","duration":1e3,"mask":!0})}))}},"保存"),i.a.createElement(_.a,{"className":j.a.inline,"type":"primary","onClick":function _publish(){n()}},"发布")))})),P=[{"type":"ImgButton"},{"type":"FloatButton"},{"type":"HotZone"},{"type":"Broadcast"},{"type":"Pay"},{"type":"ScanCode"},{"type":"TeamUp"}],T={},z=[],W={"ImgButton":{"config":Object(c.a)(Object(c.a)({},T),{},{"title":"图片组件","bgUrl":"https://resource.xinmai100.com/authUser/2021032511351877284838.png","height":200,"clickEvent":0,"applyNote":1}),"editData":[].concat(Object(r.a)(z),[{"key":"bgUrl","label":"背景图片","type":"Upload"},{"key":"clickEvent","label":"点击事件","type":"Select","optionList":[{"value":"无跳转","key":0},{"value":"跳转h5页面","key":1},{"value":"某个业务功能：）","key":3}]}])},"FloatButton":{"config":Object(c.a)(Object(c.a)({},T),{},{"title":"底部悬浮组件","bgUrl":"https://resource.xinmai100.com/authUser/2021032511292724862370.png","height":135,"clickEvent":0,"smsCode":2,"floatType":1,"areaSize":[{"key":"areaSizeWidth","label":"宽","value":100},{"key":"areaSizeHeight","label":"高","value":40}],"position":[{"key":"positionX","label":"左","value":0},{"key":"positionY","label":"上","value":0}],"initNumber":300,"fontColor":"red"}),"editData":[].concat(Object(r.a)(z),[{"key":"floatType","label":"类型","type":"Select","optionList":[{"value":"业务功能1","key":1},{"value":"业务功能2","key":0}]},{"key":"bgUrl","label":"背景图片","type":"Upload"}])},"Pay":{"config":Object(c.a)(Object(c.a)({},T),{},{"title":"业务组件A","height":667}),"editData":Object(r.a)(z)},"ScanCode":{"config":Object(c.a)(Object(c.a)({},T),{},{"title":"业务组件B","bgUrl":"https://resource.xinmai100.com/JKMarket/img/children/qrcodebg1.jpg?imageslim","height":667,"bgColor":"rgb(223, 245, 197)","marginTop":322,"codeSize":[{"key":"codeSizeWidth","label":"宽","value":206},{"key":"codeSizeHeight","label":"高","value":206}],"ifShowWX":0,"fontColor":"red"}),"editData":Object(r.a)(z)},"HotZone":{"config":Object(c.a)(Object(c.a)({},T),{},{"title":"热区组件","bgUrl":"https://resource.xinmai100.com/authUser/2021032511351877284838.png","clickEvent":0,"areaSize":[{"key":"areaSizeWidth","label":"宽","value":130},{"key":"areaSizeHeight","label":"高","value":90}],"position":[{"key":"positionX","label":"左","value":0},{"key":"positionY","label":"上","value":0}],"position2":[{"key":"positionX","label":"左","value":0},{"key":"positionY","label":"下","value":0}],"isFloat":0}),"editData":[].concat(Object(r.a)(z),[{"key":"clickEvent","label":"点击事件","type":"Select","optionList":[{"value":"无跳转","key":0},{"value":"跳转h5页面","key":1},{"value":"某个业务功能：）","key":3},{"value":"另外一个业务功能：）","key":4}]},{"key":"isFloat","label":"是否悬浮","type":"Select","optionList":[{"value":"是","key":1},{"value":"否","key":0}]},{"key":"areaSize","label":"热区大小","type":"DoubleInput","valueList":[{"key":"areaSizeWidth","label":"宽","value":0},{"key":"areaSizeHeight","label":"高","value":0}]}])},"Broadcast":{"config":Object(c.a)(Object(c.a)({},T),{},{"title":"消息通知","width":190,"height":26,"layout":"right","fontColor":"#fff","bgUrl":"https://resource.xinmai100.com/authUser/2021060214564945581011.png"}),"editData":[].concat(Object(r.a)(z),[{"key":"bgUrl","label":"背景图片","type":"Upload"},{"key":"layout","label":"布局排列","type":"Select","optionList":[{"value":"左侧","key":"left"},{"value":"右侧","key":"right"}]},{"key":"fontColor","label":"字体颜色","type":"ColorInput"}])},"TeamUp":{"config":Object(c.a)(Object(c.a)({},T),{},{"title":"业务组件C","height":290,"helpPersonNum":5,"bgUrl":""}),"editData":Object(r.a)(z)}},M=a(344),B=a(3),H=a(4),L=a(14),U=a(11),F=a(12),A=a(5);var Z=function withClickEvent(e){return function(t){Object(U.a)(_class2,t);var a=Object(F.a)(_class2);function _class2(){var e;Object(B.a)(this,_class2);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),Object(A.a)(Object(L.a)(e),"handleClick",(function(){var t=e.props,a=t.clickEvent,n=t.h5Url,o=t.scrollTop,l=t.lessonId;switch(a){case 1:e.goH5(n);break;case 2:e.goTop(o);break;case 3:case 4:e.setState({"lessonId":l,"clickEvent":a},(function(){e.checkLogin()}))}})),Object(A.a)(Object(L.a)(e),"goH5",(function(e){window.location.href=e})),Object(A.a)(Object(L.a)(e),"goTop",(function(e){var t=0==+e?1:e;Object(d.pageScrollTo)({"scrollTop":t,"duration":300})})),Object(A.a)(Object(L.a)(e),"checkLogin",(function(){})),e}return Object(H.a)(_class2,[{"key":"componentDidMount","value":function componentDidMount(){}},{"key":"render","value":function render(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(e,Object(M.a)({},this.props,{"handleClick":this.handleClick})))}}]),_class2}(i.a.Component)};function getElementSize(e,t){return e?t+"px":(2*+t*100/750).toFixed(2)+"vw"}var Y=a(795),V=a.n(Y),R=Object(l.memo)((function(e){var t=e.title,a=e.isTpl,n=(e.canDrag,e.height,e.clickEvent),o=e.refundAuthorize,l=(e.h5Url,e.scrollTop,e.lessonId,e.bgUrl);return i.a.createElement(i.a.Fragment,null,a&&i.a.createElement(_.e,{"className":V.a.imgTpl},i.a.createElement(_.b,{"className":V.a.image,"src":"https://resource.xinmai100.com/authUser/2021032511030570376929.png"}),i.a.createElement(_.e,{"className":V.a.title},t)),!a&&4!==n&&5!==n&&i.a.createElement(q,e),4===n&&i.a.createElement(_.a,{"className":V.a.wxImgButton,"onGetPhoneNumber":function getPhoneNumber(e){e.detail&&"getPhoneNumber:ok"===e.detail.errMsg||Object(d.showModal)({"content":o,"confirmText":"知道了","showCancel":!1})},"openType":"getPhoneNumber"},i.a.createElement(_.b,{"className":V.a.wxImg,"src":l})),5===n&&i.a.createElement(_.a,{"className":V.a.wxImgButton,"onContactEventDetail":function getContactDetail(){},"openType":"contact"},i.a.createElement(_.b,{"className":V.a.wxImg,"src":l})))})),q=Z((function(e){var t=e.canDrag,a=e.height,n=e.handleClick,o=e.bgUrl;return i.a.createElement(_.e,{"style":{"height":getElementSize(t,a)},"className":"".concat(V.a.imageWrapper," ").concat(t?V.a.eventsNone:""),"onClick":n},i.a.createElement(_.b,{"className":V.a.image,"src":o}))})),X=R,J=a(256),Q=a.n(J),K=function(e){Object(U.a)(InitNumber,e);var t=Object(F.a)(InitNumber);function InitNumber(){var e;Object(B.a)(this,InitNumber);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n)),Object(A.a)(Object(L.a)(e),"remain",0),Object(A.a)(Object(L.a)(e),"initTotal",e.props.initNumber),Object(A.a)(Object(L.a)(e),"state",{"total":e.props.initNumber}),e}return Object(H.a)(InitNumber,[{"key":"componentDidMount","value":function componentDidMount(){this.props.canDrag}},{"key":"render","value":function render(){var e=this.props,t=e.fontColor,a=e.initNumber,n=e.canDrag,o=this.state.total;return 0!=+a&&i.a.createElement(_.d,{"style":{"color":t,"top":getElementSize(n,32),"right":getElementSize(n,128),"width":getElementSize(n,35),"fontSize":getElementSize(n,20)},"className":Q.a.initNumber},n?a:o)}}]),InitNumber}(l.Component),$=function(e){Object(U.a)(InputContent,e);var t=Object(F.a)(InputContent);function InputContent(){var e;Object(B.a)(this,InputContent);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n)),Object(A.a)(Object(L.a)(e),"imgData",{}),Object(A.a)(Object(L.a)(e),"state",{"inputValue":""}),Object(A.a)(Object(L.a)(e),"handleChange",(function(t){var a=t.target.value;e.setState({"inputValue":a})})),e}return Object(H.a)(InputContent,[{"key":"componentDidMount","value":function componentDidMount(){!function fixInputBugs(){var e=document.documentElement.scrollTop||document.body.scrollTop;document.body.addEventListener("focusout",(function(){var t=window.navigator.userAgent;(t.indexOf("iPhone")>0||t.indexOf("iPad")>0)&&(document.body.scrollTop=e,document.documentElement.scrollTop=e)}));var t=document.getElementsByTagName("body")[0].getBoundingClientRect().height;window.addEventListener("resize",(function(){document.getElementsByTagName("body")[0].setAttribute("style","height: ".concat(t,"px"))}))}()}},{"key":"render","value":function render(){var e=this.state.inputValue,t=this.props.canDrag;return i.a.createElement(i.a.Fragment,null,i.a.createElement(_.e,{"style":{"height":getElementSize(t,73)},"className":Q.a.inputContentWrapper},i.a.createElement(_.c,{"placeholder":"请输入手机号","maxlength":11,"value":e,"onInput":this.handleChange,"type":"tel","style":{"width":getElementSize(t,240),"height":getElementSize(t,36),"fontSize":getElementSize(t,16),"marginLeft":getElementSize(t,17)}}),i.a.createElement(_.e,{"style":{"opacity":"0","marginRight":getElementSize(t,10),"width":getElementSize(t,200),"height":getElementSize(t,50)},"className":Q.a.submit})))}}]),InputContent}(l.Component),G=Object(l.memo)((function(e){e.areaSize;var t=e.title,a=e.isTpl,n=e.canDrag,o=e.height,c=e.bgUrl,r=e.initNumber,u=e.fontColor,s=e.floatType,m=e.smsCode;e.position;return Object(l.useEffect)((function(){}),[]),i.a.createElement(i.a.Fragment,null,a&&i.a.createElement(_.e,{"className":Q.a.imgTpl},i.a.createElement(_.b,{"className":Q.a.image,"src":"https://resource.xinmai100.com/authUser/2021032511171930145001.png"}),i.a.createElement(_.e,{"className":Q.a.title},t)),!a&&i.a.createElement(_.e,{"style":{"height":getElementSize(n,o),"backgroundImage":"url('".concat(c,"')")},"className":"".concat(Q.a.imageWrapper," ").concat(n?Q.a.eventsNone:"")},1===s?i.a.createElement($,{"canDrag":n,"smsCode":+m}):null,1===s?i.a.createElement(K,{"canDrag":n,"initNumber":+r,"fontColor":u}):null,0===s?i.a.createElement(ee,e):null))})),ee=Z((function(e){var t=e.position,a=e.canDrag,n=e.areaSize,o=e.handleClick;return i.a.createElement(_.d,{"style":{"width":getElementSize(a,n[0].value),"height":getElementSize(a,n[1].value),"left":getElementSize(a,t[0].value),"top":getElementSize(a,t[1].value),"fontSize":getElementSize(a,16),"backgroundColor":a?"rgba(0,0,0,0.3)":"transparent"},"onClick":o,"className":Q.a.floatClick},a?"点击区域":"")})),te=G,ae=a(796),ne=a.n(ae),oe=function(e){Object(U.a)(Pay,e);var t=Object(F.a)(Pay);function Pay(){return Object(B.a)(this,Pay),t.apply(this,arguments)}return Object(H.a)(Pay,[{"key":"render","value":function render(){var e=this.props,t=e.isTpl,a=e.title;return t?i.a.createElement(_.e,{"className":ne.a.imgTpl},i.a.createElement(_.b,{"className":ne.a.image,"src":"https://resource.xinmai100.com/authUser/2021032518444690562629.png"}),i.a.createElement(_.e,{"className":ne.a.title},a)):i.a.createElement(_.e,null,"业务组件A")}}]),Pay}(l.Component),le=a(797),ie=a.n(le),ce=Object(l.memo)((function(e){var t=e.title,a=e.isTpl;return i.a.createElement(i.a.Fragment,null,a&&i.a.createElement(_.e,{"className":ie.a.imgTpl},i.a.createElement(_.b,{"className":ie.a.image,"src":"https://resource.xinmai100.com/authUser/2021032511230573317672.png"}),i.a.createElement(_.e,{"className":ie.a.title},t)),!a&&i.a.createElement(_.e,null,"业务组件B"))})),re=a(798),ue=a.n(re),se=Z((function(e){var t=e.canDrag,a=e.areaSize,n=e.isFloat,o=e.handleClick;return i.a.createElement(_.e,{"style":{"width":getElementSize(t,a[0].value),"height":getElementSize(t,a[1].value)},"className":"".concat(ue.a.imageWrapper," ").concat(t?ue.a.eventsNone:ue.a.removeBgColor),"onClick":o},1===n&&t?"悬浮":null,0===n&&t?"非悬浮":null)})),me=function HotZone(e){var t=e.isTpl,a=e.title;return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(_.e,{"className":ue.a.imgTpl},i.a.createElement(_.b,{"className":ue.a.image,"src":"https://resource.xinmai100.com/authUser/2021052714263617413790.png"}),i.a.createElement(_.e,{"className":ue.a.title},a)),!t&&i.a.createElement(se,e))},pe=function(e){Object(U.a)(Scroll,e);var t=Object(F.a)(Scroll);function Scroll(){var e;Object(B.a)(this,Scroll);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n)),Object(A.a)(Object(L.a)(e),"state",{"rollClass":""}),Object(A.a)(Object(L.a)(e),"setScrollStyle",(function(){var e=Math.random().toString(36).substr(2),t=document.createElement("style");return t.innerHTML="@-webkit-keyframes rowup".concat(e," {\n              0% {\n                  -webkit-transform: translate3d(0, 0, 0);\n                  transform: translate3d(0, 0, 0);\n              }\n              25% {\n                -webkit-transform: translate3d(0, 0, 0);\n                transform: translate3d(0, 0, 0);\n              }\n              75% {\n                  -webkit-transform: translate3d(0, 0, 0);\n                  transform: translate3d(0, 0, 0);\n              }\n              100% {\n                  -webkit-transform: translate3d(0, -50%, 0);\n                  transform: translate3d(0, -50%, 0);\n              }\n          }\n          @keyframes rowup").concat(e," {\n            0% {\n                -webkit-transform: translate3d(0, 0, 0);\n                transform: translate3d(0, 50%, 0);\n            }\n            25% {\n                -webkit-transform: translate3d(0, 0, 0);\n                transform: translate3d(0, 0, 0);\n            }\n            75% {\n                -webkit-transform: translate3d(0, 0, 0);\n                transform: translate3d(0, 0, 0);\n            }\n            100% {\n                -webkit-transform: translate3d(0,-100%, 0);\n                transform: translate3d(0,-100%, 0);\n            }\n        }\n        .rowup-").concat(e,"{\n            -webkit-animation:3s rowup").concat(e," linear infinite normal;\n            animation: 3s rowup").concat(e," linear infinite normal;\n        }"),document.getElementsByTagName("head")[0].appendChild(t),"rowup-".concat(e)})),e}return Object(H.a)(Scroll,[{"key":"componentDidMount","value":function componentDidMount(){if(document.querySelector(".scroll .scroll-content")){var e=this.setScrollStyle(this.props.speed);this.setState({"rollClass":e})}}},{"key":"render","value":function render(){var e=this.state.rollClass?" "+this.state.rollClass:"";return i.a.createElement(_.e,{"className":"scroll","style":{"height":this.props.height}},i.a.createElement(_.e,{"className":"scroll-content"+e},this.props.children))}}]),Scroll}(i.a.Component),de=a(799),ge=a.n(de),fe=function(e){Object(U.a)(Broadcast,e);var t=Object(F.a)(Broadcast);function Broadcast(){var e;Object(B.a)(this,Broadcast);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n)),Object(A.a)(Object(L.a)(e),"channel",d.default.getCurrentInstance().router.params.channel||""),Object(A.a)(Object(L.a)(e),"state",{"list":[],"uiData":[]}),e}return Object(H.a)(Broadcast,[{"key":"componentDidMount","value":function componentDidMount(){window.location.href.indexOf("home")}},{"key":"render","value":function render(){var e=this.props,t=e.title,a=e.isTpl,n=e.canDrag,o=e.width,l=e.height,c=e.bgUrl,r=e.fontColor,u=this.state,s=u.list,m=u.uiData.slice(0,1);return i.a.createElement(i.a.Fragment,null,a&&i.a.createElement(_.e,{"className":ge.a.imgTpl},i.a.createElement(_.b,{"className":ge.a.image,"src":"https://resource.xinmai100.com/authUser/2021060110342073400269.png"}),i.a.createElement(_.e,{"className":ge.a.title},t)),!a&&n&&i.a.createElement(_.e,{"style":{"width":getElementSize(n,o),"height":getElementSize(n,l),"color":r,"backgroundImage":"url('".concat(c,"')")},"className":"imageWrapper ".concat(ge.a.imageWrapper," ").concat(n?ge.a.eventsNone:null)},i.a.createElement(_.e,{"style":{"height":getElementSize(n,l),"lineHeight":getElementSize(n,l)},"className":ge.a.text},"199******88已报名，1分钟前")),!a&&!n&&s.length>0&&i.a.createElement(_.e,{"style":{"width":getElementSize(n,o),"height":getElementSize(n,l),"color":r,"backgroundImage":"url('".concat(c,"')")},"className":"imageWrapper ".concat(ge.a.imageWrapper," ").concat(n?ge.a.eventsNone:null)},i.a.createElement(pe,null,m.map((function(e,t){return i.a.createElement(_.e,{"style":{"height":getElementSize(n,l),"lineHeight":getElementSize(n,l)},"key":t,"className":ge.a.text},e.message)})))))}}]),Broadcast}(l.Component),_e=a(800),be=a.n(_e),ve=function(e){Object(U.a)(TeamUp,e);var t=Object(F.a)(TeamUp);function TeamUp(){return Object(B.a)(this,TeamUp),t.apply(this,arguments)}return Object(H.a)(TeamUp,[{"key":"render","value":function render(){var e=this.props,t=e.isTpl,a=e.title;return t?i.a.createElement(_.e,{"className":be.a.imgTpl},i.a.createElement(_.b,{"className":be.a.image,"src":"https://resource.xinmai100.com/authUser/2021071315311487228267.png"}),i.a.createElement(_.e,{"className":be.a.title},a)):i.a.createElement(_.e,null,"业务组件C")}}]),TeamUp}(l.Component),ye=function DynamicEngine(e){var t,a=e.type,n=e.config,o=e.isTpl,l=e.canDrag;switch(a){case"ImgButton":t=X;break;case"FloatButton":t=te;break;case"HotZone":t=me;break;case"Broadcast":t=fe;break;case"Pay":t=oe;break;case"ScanCode":t=ce;break;case"TeamUp":t=ve}return i.a.createElement(t,Object(M.a)({"canDrag":l},n,{"isTpl":o}))},he=a(949),Ee=Object(l.memo)((function(e){var t=e.children,a=e.templateData,n=e.editData,o=Object(he.a)({"item":{"type":a.type,"templateData":a,"editData":n},"collect":function collect(e){return{"isDragging":e.isDragging()}}}),r=Object(u.a)(o,2),s=r[0].isDragging,m=r[1],p=Object(l.useMemo)((function(){return{"opacity":s?.4:1}}),[s]);return i.a.createElement(_.e,{"className":j.a.listItem,"style":Object(c.a)({},p),"ref":m},t)})),xe=function Left(){var e=Object(l.useContext)(b).pageInfo,t=void 0===e?{}:e,a=Object(l.useState)([]),n=Object(u.a)(a,2),o=n[0],c=n[1],r=function getData(e){var t=e.type,a=function getSchema(e){return W[e]}(t),n=a.config;return{"type":t,"config":n,"templateData":{"type":t,"config":n},"editData":a.editData}};return Object(l.useEffect)((function(){if(t){var e=2===t.pageScenes||4===t.pageScenes?P:P.filter((function(e){return"Pay"!==e.type}));c(e)}}),[t]),i.a.createElement(_.e,{"className":j.a.left},i.a.createElement(_.e,{"className":j.a.listWrap},o.map((function(e){var t=r(e),a=t.templateData,n=t.type,o=t.config,l=t.editData;return i.a.createElement(Ee,{"key":n,"editData":l,"templateData":a},i.a.createElement(ye,{"type":n,"config":o,"isTpl":!0}))}))))},Oe=a(948),je=function updateData(e){var t=e.value,a=e.curPointData,n=e.name,o=e.setcurPointData,l=e.pointData,i=e.updatePointData,r=Object(c.a)({},a.config);Array.isArray(n)?n.forEach((function(e,a){r[e]=t[a]})):r[n]=t;var u=Object(c.a)(Object(c.a)({},a),{},{"config":r});o(u),i(l.map((function(e){return e.i===u.i?Object(c.a)({},u):e})))},ke=a(802),De=a.n(ke),Ce=function HotZone(e){var t=e.id,a=e.handleClickTemplate,n=e.handleContextMenu,o=e.style,l=e.children,c=e.className,r=Object(he.a)((function(){return{"item":{"type":"HotZoneBox","id":t}}}),[]),s=Object(u.a)(r,2)[1];return i.a.createElement(_.e,{"className":c,"ref":s,"onClick":a,"onContextMenu":n,"style":o},l)},Ne=a(813),Ie=a.n(Ne),Se=Object(ke.WidthProvider)(De.a),we=function ViewRender(e){var t=e.pointData,a=e.canDrag,n=Object(l.useContext)(b),o=n.updatePointData,s=n.setcurPointData,m=n.curPointData,p=n.contextMenuVisible,d=n.setcontextMenuVisible,g=n.setcontextMenuPosition,f=Object(l.useState)(!1),v=Object(u.a)(f,2),y=v[0],h=v[1],E=function onLayoutChange(e){if(a){var n=function getPointData(e,t,a){return Object(r.a)(e).map((function(e){var n=Object(c.a)({},e);return t.forEach((function(t){e.i===t.i&&(n=Object(c.a)(Object(c.a)(Object(c.a)({},e),t),{},{"isDraggable":!!a}))})),n}))}(t,e,a);o(n)}},x=function handleClickTemplate(e,t){a&&(d(!1),t.preventDefault(),t.stopPropagation(),s(e))};Object(l.useEffect)((function(){a&&document.addEventListener("click",(function(){d(!1)}));var e=document.body.clientWidth>1200;h(e)}),[]);var O=Object(l.useState)([]),j=Object(u.a)(O,2),k=j[0],D=j[1],C=Object(l.useState)([]),N=Object(u.a)(C,2),I=N[0],S=N[1],w=Object(l.useState)([]),P=Object(u.a)(w,2),T=P[0],z=P[1],W=Object(l.useState)([]),M=Object(u.a)(W,2),B=M[0],H=M[1],L=Object(l.useState)([]),U=Object(u.a)(L,2),F=U[0],A=U[1];Object(l.useEffect)((function(){var e=Object(r.a)(t),a=e.filter((function(e){return"FloatButton"===e.type})),n=e.filter((function(e){return"FloatButton"!==e.type&&"HotZone"!==e.type&&"Broadcast"!==e.type})),o=e.filter((function(e){return"HotZone"===e.type&&0===e.config.isFloat})),l=e.filter((function(e){return"HotZone"===e.type&&1===e.config.isFloat})),i=e.filter((function(e){return"Broadcast"===e.type}));S(a),D(n),z(o),H(l),A(i)}),[t]);var Z=function onContextMenu(e,t){if(t.preventDefault(),t.stopPropagation(),a&&m&&m.i===e.i){var n=Y(e,t),o=V(e,t);d(!0),g({"left":n,"top":o})}},Y=function getpositionLeft(e,t){if("HotZone"===e.type)return+e.config.position[0].value+t.offsetX;if("Broadcast"===e.type){var a=e.config,n=a.width;return("left"===a.layout?0:375-+n)+t.offsetX}return t.offsetX},V=function getpositionTop(e,t){var a=+R(e,t.target)[1],n=q(e,a),o=X(e);return t.offsetY+a+n-o},R=function getTransformY(e,t){if("HotZone"===e.type)return[0,e.config.position[1].value];if("Broadcast"===e.type)return[0,40];return(t.style.transform||t.style.webkitTransform).replace(/(\d)+(px)/gi,(function(e){return e=e.replace(/px/i,"")})).match(/\d+/g)},q=function getFloatY(e){return"FloatButton"!==e.type?0:667-document.getElementById("floatPointDataWrapper").offsetHeight},X=function getScrollY(e){return"FloatButton"===e.type||"HotZone"===e.type&&1===e.config.isFloat?0:document.getElementById("basePointDataWrapper").scrollTop};return i.a.createElement(i.a.Fragment,null,k.length>0&&i.a.createElement(_.e,{"onWheel":function onWheel(){p&&d(!1)},"id":"basePointDataWrapper","style":{"height":y?"667px":"100vh","overflowY":y?"auto":"","overflowX":"hidden"},"className":Ie.a.basePointDataWrapper},i.a.createElement(_.e,{"id":"basePointDataScrollWrapper","style":{"position":"relative"}},a?i.a.createElement(Se,{"cols":24,"rowHeight":1,"layout":k,"margin":[0,0],"className":Ie.a.layout,"onLayoutChange":E,"style":{"width":"100%"}},k.map((function(e){var t=e.type,n=e.config,o=e.i;return i.a.createElement(_.e,{"key":o,"className":"\n                    ".concat(a?Ie.a.dragItem:"","\n                  "),"onClick":function onClick(t){x(e,t)},"onContextMenu":function onContextMenu(t){Z(e,t)},"style":{"left":"0","top":"0"}},m&&m.i===o?i.a.createElement(_.e,{"className":Ie.a.dragItemChild}):null,i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))}))):k.map((function(e){var t=e.type,n=e.config,o=e.i;return i.a.createElement(_.e,{"key":o,"className":"\n                  ".concat(a?Ie.a.dragItem:"","\n                "),"onClick":function onClick(t){x(e,t)},"onContextMenu":function onContextMenu(t){Z(e,t)},"style":{"left":"0","top":"0"}},m&&m.i===o?i.a.createElement(_.e,{"className":Ie.a.dragItemChild}):null,i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))})),a?T.length>0&&T.map((function(e){var t=e.type,n=e.config,o=e.i,l=n.position;return i.a.createElement(Ce,{"key":o,"handleClickTemplate":function handleClickTemplate(t){x(e,t)},"handleContextMenu":function handleContextMenu(t){Z(e,t)},"id":o,"className":Ie.a.dragItemHotZone,"style":{"position":"absolute","left":getElementSize(a,l[0].value),"top":getElementSize(a,l[1].value),"zIndex":"91"}},m&&m.i===o?i.a.createElement(_.e,{"className":Ie.a.dragItemHotZoneChild}):null,i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))})):T.length>0&&T.map((function(e){var t=e.type,n=e.config,o=e.i,l=n.position;return i.a.createElement(_.e,{"key":o,"onClick":function onClick(t){x(e,t)},"handleContextMenu":function handleContextMenu(t){Z(e,t)},"id":o,"className":Ie.a.dragItemHotZone,"style":{"position":"absolute","left":getElementSize(a,l[0].value),"top":getElementSize(a,l[1].value),"zIndex":"91"}},i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))})),F.length>0&&F.map((function(e){var t=e.type,n=e.config,o=e.i,l=n.layout;return i.a.createElement(_.e,{"key":o,"onClick":function onClick(t){x(e,t)},"onContextMenu":function onContextMenu(t){Z(e,t)},"id":o,"className":Ie.a.dragItem,"style":{"position":"absolute","left":"left"===l?0:"auto","right":"right"===l?0:"auto","top":getElementSize(a,40),"zIndex":"301"}},a&&m&&m.i===o?i.a.createElement(_.e,{"className":Ie.a.dragItemChild}):null,i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))})))),I.length>0?i.a.createElement(_.e,{"style":{"position":a?"absolute":"fixed","overflow":"hidden"},"id":"floatPointDataWrapper","className":Ie.a.floatPointDataWrapper},a?i.a.createElement(Se,{"cols":24,"rowHeight":1,"layout":I,"margin":[0,0],"className":Ie.a.layout,"onLayoutChange":E,"style":{"width":"100%"}},I.map((function(e){var t=e.type,n=e.config,o=e.i;return i.a.createElement(_.e,{"key":o,"className":"\n                        ".concat(a?Ie.a.dragItem:"","\n                      "),"onClick":function onClick(t){x(e,t)},"onContextMenu":function onContextMenu(t){Z(e,t)},"style":{"left":"0","top":"0"}},m&&m.i===o?i.a.createElement(_.e,{"className":Ie.a.dragItemChild}):null,i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))}))):I.map((function(e){var t=e.type,n=e.config,o=e.i;return i.a.createElement(_.e,{"key":o,"className":a?Ie.a.dragItem:"","onClick":function onClick(t){x(e,t)},"onContextMenu":function onContextMenu(t){Z(e,t)},"style":{"left":"0","top":"0"}},m&&m.i===o?i.a.createElement(_.e,{"className":Ie.a.dragItemChild}):null,i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))}))):null,B.length>0&&(a?B.map((function(e){var t=e.type,n=e.config,o=e.i,l=n.position,c=n.position2,r=1===n.isFloat?null:getElementSize(a,l[1].value),u=1===n.isFloat?getElementSize(a,c[1].value):null,s=1===n.isFloat?getElementSize(a,c[0].value):getElementSize(a,l[0].value);return i.a.createElement(Ce,{"key":o,"handleClickTemplate":function handleClickTemplate(t){x(e,t)},"handleContextMenu":function handleContextMenu(t){Z(e,t)},"id":o,"className":Ie.a.dragItemHotZone,"style":{"position":"absolute","left":s,"top":r,"bottom":u,"zIndex":"101"}},m&&m.i===o?i.a.createElement(_.e,{"className":Ie.a.dragItemHotZoneChild}):null,i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))})):B.map((function(e){var t=e.type,n=e.config,o=e.i,l=n.position,c=n.position2,r=1===n.isFloat?null:getElementSize(a,l[1].value),u=1===n.isFloat?getElementSize(a,c[1].value):null,s=1===n.isFloat?getElementSize(a,c[0].value):getElementSize(a,l[0].value);return i.a.createElement(_.e,{"key":o,"handleClickTemplate":function handleClickTemplate(t){x(e,t)},"handleContextMenu":function handleContextMenu(t){Z(e,t)},"id":o,"className":Ie.a.dragItemHotZone,"style":{"position":"absolute","left":s,"top":r,"bottom":u,"zIndex":"101"}},i.a.createElement(ye,{"canDrag":a,"type":t,"config":n}))}))))},Pe=Object(l.memo)((function(){var e=Object(l.useContext)(b),t=e.contextMenuVisible,a=e.contextMenuPosition,n=e.deleteCurPointData,o=e.copyCurPointData,c=a.top,r=a.left;return t?i.a.createElement(_.e,{"style":{"top":"".concat(c,"px"),"left":"".concat(r,"px")},"onClick":function clickContextMenu(e){e.preventDefault(),e.stopPropagation()},"className":j.a.menuList},i.a.createElement(_.e,{"onClick":n,"className":j.a.menuItem},"删除"),i.a.createElement(_.e,{"onClick":o,"className":j.a.menuItem},"复制")):null})),Te=function SourceBox(e){var t=document.getElementById("basePointDataScrollWrapper"),a=e.allType,n=e.dragState,o=Object(l.useContext)(b),s=o.pointData,m=o.addPointData,p=(o.curPointData,o.setcurPointData),g=o.updatePointData,v=o.setcontextMenuVisible,y=Object(Oe.a)({"accept":a,"drop":function drop(e,t){if("HotZoneBox"!==e.type){var a=e.editData,n=e.templateData,o=n.type,l=n.config;if(0!==s.filter((function(e){return"FloatButton"!==e.type&&"HotZone"!==e.type})).length||0!==l.isFloat){var i=l;if("HotZone"===e.type){var r=O(t,n);i=Object(c.a)(Object(c.a)({},l),{},{"position":r})}var u={"type":o,"config":i,"i":f()(),"x":0,"y":D(t),"w":24,"h":l.height,"isBounded":!0,"isResizable":!1,"editData":a};m(u)}else alert("请先拖入图片组件")}else O(t)},"collect":function collect(e){return{"isOver":e.isOver()}}}),h=Object(u.a)(y,2),E=h[0].isOver,x=h[1],O=function _addHotZoneData(e,t){var a=e.getItem().type;if("HotZoneBox"===a||"HotZone"===a){var n="HotZoneBox"===a?s.filter((function(t){return t.i===e.getItem().id}))[0]:t,o=n.config.isFloat,l=k({"monitor":e,"curDragdata":n,"monitorType":a,"isFloat":1===o});if("HotZone"===a)return l;je({"value":l,"curPointData":n,"name":1===o?"position2":"position","setcurPointData":p,"pointData":s,"updatePointData":g}),v(!1)}else Object(d.showToast)({"title":"请拖动热区组件","icon":"none","duration":1e3})},k=function getHotBoxPositon(e){var a=e.monitor,n=e.curDragdata,o=e.monitorType,l=e.isFloat,i=l?n.config.position2:n.config.position,u=Object(r.a)(i),s="HotZoneBox"===o?a.getDifferenceFromInitialOffset().x:0,m=u[0].value+s,p=375-n.config.areaSize[0].value,d=m<0?0:m>p?p:m,g=C(),f="HotZoneBox"===o?a.getDifferenceFromInitialOffset().y:g,_=u[1].value+f,b=u[1].value+-f,v=(1===n.config.isFloat?667:t.clientHeight)-n.config.areaSize[1].value,y=_<0?0:_>v?v:_,h=b<0?0:b>v?v:b;return[Object(c.a)(Object(c.a)({},i[0]),{},{"value":d}),Object(c.a)(Object(c.a)({},i[1]),{},{"value":l?h:y})]},D=function getInitY(e){var t=document.getElementById("canvasWrapper").getBoundingClientRect().top,a=e.getSourceClientOffset();return(a.y<t?0:a.y-t)+C()},C=function getScrollY(){var e=document.getElementById("basePointDataWrapper");return e?e.scrollTop:0},N=E?.7:1;return Object(l.useMemo)((function(){return i.a.createElement(_.e,{"style":{"transform":"translate(".concat(n.x,"px,").concat(n.y,"px)")},"className":j.a.canvasBox},i.a.createElement(_.e,{"id":"canvasWrapper","className":j.a.canvas,"style":{"opacity":N},"ref":x},s.length>0?i.a.createElement(we,{"canDrag":!0,"pointData":s}):null,i.a.createElement(Pe,null)))}),[n,x,N,s])},ze=function Grid(){return i.a.createElement("svg",{"className":j.a.grid,"width":"100%","height":"100%","xmlns":"http://www.w3.org/2000/svg"},i.a.createElement("defs",null,i.a.createElement("pattern",{"id":"smallGrid","width":"7.236328125","height":"7.236328125","patternUnits":"userSpaceOnUse"},i.a.createElement("path",{"d":"M 7.236328125 0 L 0 0 0 7.236328125","fill":"none","stroke":"rgba(207, 207, 207, 0.3)","strokeWidth":"1"})),i.a.createElement("pattern",{"id":"grid","width":"50","height":"50","patternUnits":"userSpaceOnUse"},i.a.createElement("rect",{"width":"50","height":"50","fill":"url(#smallGrid)"}),i.a.createElement("path",{"d":"M 50 0 L 0 0 0 50","fill":"none","stroke":"rgba(186, 186, 186, 0.5)","strokeWidth":"1"}))),i.a.createElement("rect",{"width":"100%","height":"100%","fill":"url(#grid)"}))},We=function Canvas(){var e=Object(l.useRef)(null),t=Object(l.useContext)(b),a=t.setcurPointData,n=t.contextMenuVisible,o=t.setcontextMenuVisible,c=Object(l.useState)({"x":0,"y":0,"move":!1}),r=Object(u.a)(c,2),s=r[0],m=r[1],p=Object(l.useState)({"x":100,"y":100}),d=Object(u.a)(p,2),g=d[0],f=d[1],v=(Object(l.useMemo)((function(){return function(t){t.target===e.current&&m({"x":t.clientX,"y":t.clientY,"move":!0})}}),[]),Object(l.useMemo)((function(){return function(e){if(s.move){var t=e.clientX,a=e.clientY,n=t-s.x,o=a-s.y;m({"move":!0,"x":t,"y":a}),f((function(e){return{"x":y(e.x+n),"y":v(e.y+o)}}))}}}),[s.move,s.x,s.y]),Object(l.useMemo)((function(){return function(){m({"move":!1,"x":0,"y":0})}}),[]),Object(l.useMemo)((function(){return function(e){var t=e;return t>=133?t=133:t<=0&&(t=0),t}}),[])),y=Object(l.useMemo)((function(){return function(e){var t=e;return t>=625?t=625:t<=0&&(t=0),t}}),[]),h=Object(l.useMemo)((function(){var e=[];return P.forEach((function(t){e.push(t.type)})),[].concat(e,["HotZoneBox"])}),[P]);return i.a.createElement(_.e,{"ref":e,"className":j.a.canvasWrapper,"onClick":function handleClickMiddle(){n?o(!1):a(null)},"onContextMenu":function onContextMenu(e){e.preventDefault(),e.stopPropagation()}},i.a.createElement(ze,null),i.a.createElement(Te,{"dragState":g,"allType":h}))},Me=function PageList(){var e=Object(l.useContext)(b),t=e.pageInfo,a=e.currentPage,n=e.changePage,o=t.pageList,c=void 0===o?[]:o;return i.a.createElement(_.e,{"className":j.a.pageList},c.map((function(e){return i.a.createElement(_.e,{"key":e.pageId,"onClick":function onClick(){return n(e)},"className":"".concat(j.a.pageListItem," ").concat(e.pageId===a.pageId?j.a.active:"")},i.a.createElement(_.e,{"title":e.title,"className":j.a.title},e.title))})))},Be=function Middle(){var e=Object(l.useContext)(b),t=e.pageInfo,a=e.currentPage;return i.a.createElement(_.e,{"className":j.a.middle},t&&a&&i.a.createElement(Me,null),i.a.createElement(We,null))},He=a(814),Le=a.n(He),Ue=function App(e){var t=Object(l.useContext)(b),a=t.curPointData,n=t.setcurPointData,o=t.pointData,c=t.updatePointData,r=e.name,s=e.type,m=Object(l.useState)(""),p=Object(u.a)(m,2),d=p[0],g=p[1];Object(l.useEffect)((function(){return g(a.config[r]),function(){g("")}}),[a]);return i.a.createElement(_.e,{"className":Le.a.inputWrapper},i.a.createElement(_.c,{"value":d,"name":r,"onInput":function handleChange(e){var t=e.target.value;g(t),je({"value":t,"curPointData":a,"name":r,"setcurPointData":n,"pointData":o,"updatePointData":c})},"type":s}))},Fe=a(815),Ae=a.n(Fe),Ze=function App(e){var t=Object(l.useContext)(b),a=t.curPointData,n=t.setcurPointData,o=t.pointData,c=t.updatePointData,r=e.name,s=e.optionList,m=Object(l.useState)(""),p=Object(u.a)(m,2),d=p[0],g=p[1],f=Object(l.useState)(!1),v=Object(u.a)(f,2),y=v[0],h=v[1],E=Object(l.useState)(""),x=Object(u.a)(E,2),O=x[0],j=x[1];Object(l.useEffect)((function(){document.addEventListener("click",(function(){return h(!1)}))}),[]);var k=function changeActiveKey(e){g(e.key),function handleChange(e){var t=e.key;je({"value":t,"curPointData":a,"name":r,"setcurPointData":n,"pointData":o,"updatePointData":c})}(e)};return Object(l.useEffect)((function(){return g(a.config[r]),j(11),function(){g("")}}),[a]),Object(l.useEffect)((function(){var e="";s.forEach((function(t){t.key===a.config[r]&&(e=t.value)})),j(e)}),[a]),i.a.createElement(_.e,{"className":Ae.a.selectWrapper},i.a.createElement(_.e,{"onClick":function toogleSelect(e){e.stopPropagation(),h(!y)},"className":Ae.a.selectInput},O?i.a.createElement(_.e,{"className":Ae.a.activeOption},O):null,i.a.createElement(_.e,{"className":"".concat(Ae.a.optionList," ").concat(y?Ae.a.active:"")},s.length>0&&s.map((function(e){return i.a.createElement(_.e,{"onClick":function onClick(){return k(e)},"key":e.value,"className":"".concat(Ae.a.optionItem," ").concat(e.key===d?Ae.a.optionItemAcitve:""," ")},e.value)})))))},Ye=a(816),Ve=a.n(Ye),Re=function App(e){var t=Object(l.useContext)(b),a=t.curPointData,n=t.setcurPointData,o=t.pointData,c=t.updatePointData,r=e.name,s=function handleChange(e){var t="Broadcast"===a.type||"TeamUp"===a.type?e.width:"100%",l=["width","height",r];"TeamUp"===a.type&&(l=["bgWidth","bgHeight",r]),je({"value":[t,e.height,e.bgUrl],"curPointData":a,"name":l,"setcurPointData":n,"pointData":o,"updatePointData":c})},g=Object(l.useState)(""),f=Object(u.a)(g,2),v=f[0],y=f[1],h=function(){var e=Object(p.a)(m.a.mark((function _callee(e){var t;return m.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,request("/api/xinmai-admin-order/taka-token",{"bizType":"authUser"});case 2:t=a.sent,E(e,t);case 4:case"end":return a.stop()}}),_callee)})));return function getUrl(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(p.a)(m.a.mark((function _callee2(e,t){return m.a.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:Object(d.uploadFile)({"url":"".concat(t.data.uploadDomain,"/v1/file"),"filePath":e,"name":"file","formData":{"isFullWrite":1,"customFilePath":t.data.customFilePath+".png"},"header":{"token":t.data.token},"success":function success(e){var t=JSON.parse(e.data),a=t.data[0].metadata.width/2,n=t.data[0].metadata.height/2,o=t.data[0].publishUrl;s({"width":a,"height":n,"bgUrl":o})}});case 1:case"end":return a.stop()}}),_callee2)})));return function uploadFile(t,a){return e.apply(this,arguments)}}();return Object(l.useEffect)((function(){return y(a.config[r]),function(){y("")}}),[a]),i.a.createElement(_.e,{"onClick":function upload(){Object(d.chooseImage)({"count":1,"sizeType":["original","compressed"],"sourceType":["album","camera"],"success":function success(e){var t=e.tempFilePaths[0];y(t),h(t)}})},"className":Ve.a.upload},i.a.createElement(_.b,{"className":Ve.a.imgUrl,"src":v}))},qe=a(817),Xe=a.n(qe),Je=function App(e){var t=Object(l.useContext)(b),a=t.curPointData,n=t.setcurPointData,o=t.pointData,r=t.updatePointData,s=Object(l.useState)([]),m=Object(u.a)(s,2),p=m[0],d=m[1],g=e.type,f=e.name;Object(l.useEffect)((function(){return d(a.config[f]),function(){d([])}}),[a]);var v=function handleChange(e,t){var l=t.target.value,i=0===e?[Object(c.a)(Object(c.a)({},p[e]),{},{"value":l}),p[1]]:[p[0],Object(c.a)(Object(c.a)({},p[e]),{},{"value":l})];d(i),je({"value":i,"curPointData":a,"name":f,"setcurPointData":n,"pointData":o,"updatePointData":r})};return i.a.createElement(_.e,{"className":Xe.a.inputWrapper},p.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(_.e,{"className":Xe.a.dbInput},i.a.createElement(_.c,{"value":p[0].value,"onInput":function onInput(e){return v(0,e)},"type":g}),i.a.createElement(_.d,{"className":Xe.a.title},p[0].label)),i.a.createElement(_.e,{"className":Xe.a.dbInput},i.a.createElement(_.c,{"value":p[1].value,"onInput":function onInput(e){return v(1,e)},"type":g,"min":0}),i.a.createElement(_.d,{"className":Xe.a.title},p[1].label))))},Qe=a(937),Ke=a(930),$e=a.n(Ke),Ge=function App(e){var t=Object(l.useContext)(b),a=t.curPointData,n=t.setcurPointData,o=t.pointData,c=t.updatePointData,r=e.name,s=(e.type,Object(l.useState)("")),m=Object(u.a)(s,2),p=m[0],d=m[1],g=Object(l.useState)(!1),f=Object(u.a)(g,2),v=f[0],y=f[1];Object(l.useEffect)((function(){return d(a.config[r]),function(){d("")}}),[a]);return i.a.createElement(_.e,{"className":$e.a.inputWrapper},i.a.createElement(_.e,{"className":$e.a.target,"onClick":function onClick(){return y(!0)}},i.a.createElement(_.e,{"className":$e.a.targetInput,"style":{"backgroundColor":p}})),v?i.a.createElement(_.e,{"className":$e.a.popover},i.a.createElement(_.e,{"className":$e.a.cover,"onClick":function onClick(){return y(!1)}}),i.a.createElement(Qe.a,{"color":p,"onChange":function handleChange(e){var t=e.hex;d(t),je({"value":t,"curPointData":a,"name":r,"setcurPointData":n,"pointData":o,"updatePointData":c})}})):null)},et=function Right(){var e=Object(l.useContext)(b),t=e.curPointData,a=e.editDataList;return i.a.createElement(_.e,{"className":j.a.right},i.a.createElement(_.e,{"className":j.a.rightTitle},"属性设置"),t?i.a.createElement(_.e,{"className":j.a.rightContent},a.length>0&&a.map((function(e){return i.a.createElement(_.e,{"key":e.key,"className":j.a.formItem},i.a.createElement(_.d,{"className":j.a.label},e.label),"Input"===e.type&&i.a.createElement(Ue,{"name":e.key,"type":"text"}),"Select"===e.type&&i.a.createElement(Ze,{"name":e.key,"optionList":e.optionList}),"Upload"===e.type&&i.a.createElement(Re,{"name":e.key}),"DoubleInput"===e.type&&i.a.createElement(Je,{"type":"digit","name":e.key,"valueList":e.valueList}),"ColorInput"===e.type&&i.a.createElement(Ge,{"type":"color","name":e.key}))}))):i.a.createElement(_.e,{"className":j.a.emptyEditData},"请选择组件 :)"))},tt=function Container(){var e=d.default.useRouter().params,t=e.topicId,a=void 0===t?"":t,n=(e.token,document.getElementById("basePointDataScrollWrapper")),o=function(){var e=Object(p.a)(m.a.mark((function _callee(){var e,t,n;return m.a.wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(e=JSON.parse(localStorage.getItem("topicDetailData"))){o.next=4;break}return x(!0),o.abrupt("return");case 4:(t=e.data.elements.length>0&&e.data.elements[0]?e.data.elements:E[e.data.applicationScenarios])[0].title=e.data.pageTitle,n={"pageTitle":e.data.pageTitle,"pageSubTitle":e.data.topicName,"pageType":e.data.topicType,"pageScenes":e.data.applicationScenarios,"pageList":t,"isPublish":1===e.data.isPublish,"topicId":a},s(n);case 8:case"end":return o.stop()}}),_callee)})));return function topicDetail(){return e.apply(this,arguments)}}();Object(l.useEffect)((function(){o()}),[]);var s=function setDefaultPageInfo(e){N(e),T(e.pageList[0]),B(e.pageList[0].pointData),x(!1)},g=Object(l.useState)(!1),v=Object(u.a)(g,2),y=v[0],x=v[1],O=Object(l.useState)(null),k=Object(u.a)(O,2),D=k[0],N=k[1],I=Object(l.useState)(null),S=Object(u.a)(I,2),P=S[0],T=S[1],z=Object(l.useState)([]),W=Object(u.a)(z,2),M=W[0],B=W[1],H=function addPointData(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.pageId,a=M.find((function(e){return"Pay"===e.type}));if(a)Object(d.showToast)({"title":"一个页面只允许有一个业务组件A","icon":"none","duration":1e3,"mask":!0});else{var n=[].concat(Object(r.a)(M),[e]);B(n);var o=D.pageList.map((function(e){return e.pageId===t?Object(c.a)(Object(c.a)({},e),{},{"pointData":n}):Object(c.a)({},e)}));N(Object(c.a)(Object(c.a)({},D),{},{"pageList":o}))}},L=function updatePointData(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.pageId,a=e.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{"h":+e.config.height})}));B(a);var n=D.pageList.map((function(e){return e.pageId===t?Object(c.a)(Object(c.a)({},e),{},{"pointData":a}):Object(c.a)({},e)}));N(Object(c.a)(Object(c.a)({},D),{},{"pageList":n}))},U=Object(l.useState)(null),F=Object(u.a)(U,2),A=F[0],Z=F[1],Y=function(){var e=Object(p.a)(m.a.mark((function _callee2(e){var t;return m.a.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:(t=JSON.parse(localStorage.getItem("topicDetailData"))).data.isPublish=0,t.data.elements=D.pageList,localStorage.setItem("topicDetailData",JSON.stringify(t)),o(),e&&e();case 6:case"end":return a.stop()}}),_callee2)})));return function submit(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(p.a)(m.a.mark((function _callee3(){var e;return m.a.wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:(e=JSON.parse(localStorage.getItem("topicDetailData"))).data.isPublish=1,e.data.elements=D.pageList,localStorage.setItem("topicDetailData",JSON.stringify(e)),Object(d.showToast)({"title":"发布成功","icon":"none","duration":1e3,"mask":!0}),o();case 6:case"end":return t.stop()}}),_callee3)})));return function publish(){return e.apply(this,arguments)}}(),R=Object(l.useState)(!1),q=Object(u.a)(R,2),X=q[0],J=q[1],Q=Object(l.useState)({"top":0,"left":0}),K=Object(u.a)(Q,2),$=K[0],G=K[1],ee=Object(l.useState)([]),te=Object(u.a)(ee,2),ae=te[0],ne=te[1],oe=function getEditData(){return function getClickEventData(e){var t=[];switch(A.config.clickEvent){case 1:t=[{"key":"h5Url","label":"链接地址","type":"Input"}];break;case 2:t=[{"key":"scrollTop","label":"锚定高度","type":"Input"}];break;case 3:t=[{"key":"lessonId","label":"我是label","type":"Input"}];break;default:t=[]}var a=e.findIndex((function(e){return"clickEvent"===e.key}));return[].concat(Object(r.a)(e.slice(0,a+1)),Object(r.a)(t),Object(r.a)(e.slice(a+1)))}(function getHotZoneTypeData(e){if(e.findIndex((function(e){return"isFloat"===e.key}))<0)return e;var t=1===A.config.isFloat?{"key":"position2","label":"位置坐标","type":"DoubleInput","valueList":[{"key":"positionX","label":"左","value":0},{"key":"positionY","label":"下","value":0}]}:{"key":"position","label":"位置坐标","type":"DoubleInput","valueList":[{"key":"positionX","label":"左","value":0},{"key":"positionY","label":"上","value":0}]};return[].concat(Object(r.a)(e),[t])}(function getFloatTypeData(){var e=A.editData,t=e.findIndex((function(e){return"floatType"===e.key}));if(t<0)return e;var a=[],n=[{"key":"clickEvent","label":"点击事件","type":"Select","optionList":[{"value":"无跳转","key":0},{"value":"跳转h5页面","key":1},{"value":"某个业务功能：）","key":3}]},{"key":"areaSize","label":"区域大小","type":"DoubleInput","valueList":[{"key":"areaSizeWidth","label":"宽","value":0},{"key":"areaSizeHeight","label":"高","value":0}]},{"key":"position","label":"位置坐标","type":"DoubleInput","valueList":[{"key":"positionX","label":"左","value":0},{"key":"positionY","label":"上","value":0}]}];switch(A.config.floatType){case 0:a=n;break;case 1:a=[{"key":"initNumber","label":"大小","type":"Input"},{"key":"fontColor","label":"颜色","type":"ColorInput"},{"key":"smsCode","label":"1 || 0","type":"Select","optionList":[{"value":"是","key":1},{"value":"否","key":2}]}];break;default:a=n}return[].concat(Object(r.a)(e.slice(0,t+2)),Object(r.a)(a),Object(r.a)(e.slice(t+2)))}()))};return Object(l.useEffect)((function(){var e=A?oe():[];return ne(e),function(){ne([])}}),[A]),i.a.createElement(b.Provider,{"value":{"isAdmin":h,"pageInfo":D,"setpageInfo":N,"currentPage":P,"changePage":function changePage(e){e.pageId!==P.pageId&&(T(e),L(e.pointData,e.pageId),Z(null))},"setvisible":x,"pointData":M,"updatePointData":L,"addPointData":H,"deleteCurPointData":function deleteCurPointData(){J(!1),Object(d.showModal)({"title":"确定要删除当前选中的组件吗？","content":"","success":function success(e){if(e.confirm){var t=M.filter((function(e){return e.i!==A.i})),a=0===t.filter((function(e){return"FloatButton"!==e.type&&"HotZone"!==e.type})).length?t.filter((function(e){return"HotZone"!==e.type||"HotZone"===e.type&&1===e.config.isFloat})):t;L(a),Z(null)}},"confirmColor":"#00a9ff"})},"copyCurPointData":function copyCurPointData(e){e.preventDefault(),e.stopPropagation();var t=f()(),a=Object(c.a)({},A);if(a.i=t,"HotZone"===a.type){var o=A.config.position,l=A.config.areaSize,i=Number(o[0].value)+10,r=375-Number(l[0].value),u=i<0?0:i>r?Number(o[0].value)-10:i,s=Number(o[1].value)+10,m=(1===a.config.isFloat?667:n.clientHeight)-Number(l[1].value),p=s<0?0:s>m?Number(o[1].value)-10:s,d=[Object(c.a)(Object(c.a)({},o[0]),{},{"value":u}),Object(c.a)(Object(c.a)({},o[1]),{},{"value":p})];a.config=Object(c.a)(Object(c.a)({},a.config),{},{"position":d})}H(a),Z(a),J(!1)},"curPointData":A,"setcurPointData":Z,"submit":Y,"publish":V,"contextMenuVisible":X,"setcontextMenuVisible":J,"contextMenuPosition":$,"setcontextMenuPosition":G,"editDataList":ae,"seteditDataList":ne}},y&&i.a.createElement(C,{"setpageInfo":N,"setvisible":x,"pageInfo":D,"visible":y,"setcurrentPage":T,"setpointData":B}),i.a.createElement(_.e,{"className":j.a.container},i.a.createElement(w,null),i.a.createElement(_.e,{"className":j.a.content},i.a.createElement(xe,null),i.a.createElement(Be,null),i.a.createElement(et,null))))};function index_App(e){return i.a.createElement(o.a,{"backend":n.a},i.a.createElement(tt,e))}a.d(t,"default",(function(){return index_App}))}}]);